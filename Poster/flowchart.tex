    \begin{tikzpicture}
        \tikzstyle{lagrange} = [rectangle, rounded corners, minimum height = 1cm, text centered, draw = black, fill = red!30]
    
        \tikzstyle{hamilton} = [rectangle, rounded corners, minimum height = 1cm, text centered, draw = black, fill=yellow!30]

        \tikzstyle{equations} = [rectangle, rounded corners, minimum height = 1cm, text centered, draw = black, fill=green!30]

        \tikzstyle{equations_big} = [rectangle, rounded corners, minimum height = 1cm, text centered, draw = black, fill = green!30]
        
        \tikzstyle{arrow} = [thick, ->, >=stealth]
        \tikzstyle{arrow_comes_above} = [thick, ->, >=stealth, yshift=10pt]

        \tikzstyle{vecArrow} = [thick, decoration={markings,mark=at position
    1 with {\arrow[semithick]{open triangle 60}}},
    double distance=1.4pt, shorten >= 5.5pt,
    preaction = {decorate},
    postaction = {draw,line width=1.4pt, white,shorten >= 4.5pt}]

        \node (lag1) [lagrange] {$\mathcal{L} = \mathcal{L}(\vec{r}_1^{\ \prime},  \cdots, \vec{r}_n^{\ \prime}, \dot{\vec{r}}_1^{\ \prime}, \cdots, \dot{\vec{r}}_n^{\ \prime})$};
        
        \node (lag2) [lagrange, below = 2.5 cm of lag1] {$\mathcal{L} = \mathcal{L} (\vec{r}_1, \cdots, \vec{r}_{n-1}, \dot{\vec{r}}_1, \cdots, \dot{\vec{r}}_{n-1})$};

        \node (lag3) [lagrange, below = 2.0 cm of lag2] {$\mathcal{L} = \mathcal{L}(\vec{R}_1, \cdots, \vec{R}_n, \dot{\vec{R}}_1, \cdots, \dot{\vec{R}}_{n-1}, \vec{\Omega})$};

        \node (lag4) [lagrange, below = 2.0 cm of lag3] {$\mathcal{L} = \mathcal{L}(\vec{q}_1, \cdots, \vec{q}_s, \dot{\vec{q}}_1, \cdots, \dot{\vec{q}}_s, \vec{\Omega})$};

\node (ham1) [hamilton, below = 2.5 cm of lag4] {$\mathcal{H} = \mathcal{H}(\vec{q}_1, \cdots, \vec{q}_s, \vec{p}_1, \cdots, \vec{p}_s, \vec{J})$};


\title{\parbox{\linewidth}{\centering Исследование бифуркаций в трехатомных гидридах \\ методом классических траекторий}}
\node (eq5) [equations, below = 2.0 cm of ham1] {$
        \dot{\vec{p}} = \frac{\partial \mathcal{H}}{\partial \vec{q}} \\[1ex]
        \dot{\vec{q}} = - \frac{\partial \mathcal{H}}{\partial \vec{p}} \\
        \dot{\vec{J}} + [ \frac{\partial \mathcal{H}}{\partial \vec{J}} \times \vec{J} ] = 0 
$};

        \draw [vecArrow] (lag1) -- node[anchor = east, text width = 14cm] {\vspace*{-0.8cm} \begin{center} Переход в систему отсчета, связанную с центром масс\end{center}} node[anchor = west] {\hspace{0.3cm} $\vec{r}_i^{\ \prime} = \vec{R} + \vec{r}_i$} (lag2);

        \draw [vecArrow] (lag2) -- node[anchor = east] {Переход в подвижную систему отсчета}  node[anchor = west] {\hspace{0.3cm} $\vec{r}_i = \bbS \vec{R}_i$} (lag3);

        \draw [vecArrow] (lag3) -- node[anchor = east] {Переход к обобщенным координатам} node[anchor = west] {\hspace{0.3cm} $\vec{R}_i = \vec{R}_i(q_1, \cdots, q_s)$} (lag4);

        \draw [vecArrow] (lag4) -- node[anchor = east] {Применение теоремы Донкина} node[anchor = west] {\hspace{0.3cm} $J = \frac{\partial \mathcal{L}}{\partial \Omega}, \ p = - \frac{\partial \mathcal{L}}{\partial \dot{q}}
            $}(ham1);



%\node (eq6) [equations_big, right = 3 cm of eq5] {$
%\left\{
%\begin{aligned}
%\dot{\vec{p}} &= \frac{\partial \mathcal{H}}{\partial \vec{q}} \\
%\dot{\vec{q}} &= - \frac{\partial \mathcal{H}}{\partial \vec{p}} \\
%\dot{\varphi} &= \left( \frac{\partial \mathcal{H}}{\partial J_x} \cos \varphi + \frac{\partial \mathcal{H}}{\partial J_y} \sin \varphi \right) \ctg \theta - \frac{\partial \mathcal{H}}{\partial J_z} \\
%\dot{\theta} &= \frac{\partial \mathcal{H}}{\partial J_x} \sin \varphi - \frac{\partial \mathcal{H}}{\partial J_y} \cos \varphi
%\end{aligned}
%\right.
%$};

    \end{tikzpicture}

}

